<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>63</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
</head>
<body>
<pre><code>  Miniscript Template: 3
  Title: Multi Institutional Multisig (One Agent)
  Created: 2023-09-16</code></pre>
<h1 id="name_of_template">Name of Template</h1>
<p>Multi Institutional Custody TBD Name</p>
<h1 id="goal_to_be_achieved_by_template">Goal to be achieved by template</h1>
<p>Very similar to Template 003, but the secondary agent is only a participatory signer for layers 3 &amp; 4, for principle compromised assets.</p>
<p>For previty, skipping over the context shared for template 003 as the background is the same.</p>
<h1 id="layred_security">Layred Security</h1>
<p>This is the same as Template 003, with the exception of layers 1 &amp; 2 no longer having a 1 of 3 for the secondary agent key set.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Layer Number</th>
<th style="text-align: left;">Layer Name</th>
<th style="text-align: left;">Timelock</th>
<th style="text-align: left;">Principle Key Set</th>
<th style="text-align: left;">Primary Agent Key Set</th>
<th style="text-align: left;">Secondary Agent Key Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Layer 1</td>
<td style="text-align: left;">"Happy Path"</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">2 of 3</td>
<td style="text-align: left;">2 of 3</td>
<td style="text-align: left;">None</td>
</tr>
<tr class="even">
<td style="text-align: left;">Layer 2</td>
<td style="text-align: left;">"End of Term"</td>
<td style="text-align: left;">365 Days</td>
<td style="text-align: left;">1 of 3</td>
<td style="text-align: left;">2 of 3</td>
<td style="text-align: left;">None</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Layer 3</td>
<td style="text-align: left;">"Principle Compromised"</td>
<td style="text-align: left;">395 Days</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">2 of 3</td>
<td style="text-align: left;">1 of 3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Layer 4</td>
<td style="text-align: left;">"Emergency Recovery"</td>
<td style="text-align: left;">410 Days</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">1 of 3</td>
<td style="text-align: left;">1 of 3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Layer 5</td>
<td style="text-align: left;">"Sovereign Recovery"</td>
<td style="text-align: left;">425 Days</td>
<td style="text-align: left;">2 of 3</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p>While this is modeled on a 1 year contract, layers extend past 365 days to provide disaster recovery windows to aid the principle in recovering the bitcoin while the agent may still be liable for the safe keeping of the Bitcoin.</p>
<h1 id="timelock_durations">Timelock Durations</h1>
<p>This template is modeled on a 1 year contract, since it is based on a calendar duration and not a blockheight duration, absolute epoch timestamp timelocks are utilized for the layered security.</p>
<p>Based on a given start date, this is The use of absolute epoch timestamp timelocks would look as follows:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Layer</th>
<th style="text-align: left;">Epoch Timestamp Increment</th>
<th style="text-align: left;">Epoch Timestamp Cumulative</th>
<th style="text-align: left;">Duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Layer 1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">N/A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Layer 2</td>
<td style="text-align: left;">31536000</td>
<td style="text-align: left;">31536000</td>
<td style="text-align: left;">1 Year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Layer 3</td>
<td style="text-align: left;">2592000</td>
<td style="text-align: left;">34128000</td>
<td style="text-align: left;">395 Days (~1 Year &amp; 30 Days)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Layer 4</td>
<td style="text-align: left;">1296000</td>
<td style="text-align: left;">35424000</td>
<td style="text-align: left;">410 Days (~1 Year &amp; 45 Days)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Layer 5</td>
<td style="text-align: left;">1296000</td>
<td style="text-align: left;">36720000</td>
<td style="text-align: left;">425 Days (~1 Year &amp; 60 Days)</td>
</tr>
</tbody>
</table>
<h1 id="miniscript_policy">Miniscript Policy</h1>
<p>Key Definitions:</p>
<ul>
<li>P1 = Principle Key 1</li>
<li>P2 = Principle Key 2</li>
<li>P3 = Principle Key 3</li>
</ul>
<!-- -->
<ul>
<li>A1 = Agent Key 1</li>
<li>A2 = Agent Key 2</li>
<li>A3 = Agent Key 3</li>
</ul>
<!-- -->
<ul>
<li>SA1 = Secondary Agent Key 1</li>
<li>SA2 = Secondary Agent Key 2</li>
<li>SA3 = Secondary Agent Key 3</li>
</ul>
<!-- -->
<ul>
<li>M1 = Recovery Key 1</li>
<li>M2 = Recovery Key 2</li>
<li>M3 = Recovery Key 3</li>
</ul>
<p>Time 2 - When Layer 2 is Active Time 3 - When Layer 3 is Active Time 4 - When Layer 4 is Active Time 5 - When Layer 5 is Active</p>
<p><code>&#xA0;&#xA0;&#xA0;or(99@thresh(2,thresh(2,pk(A1),pk(A2),pk(A3),after(Time&#xA0;4)),or(10@thresh(2,pk(P1),pk(P2),pk(P3),after(Time&#xA0;2)),and(thresh(1,pk(SA1),pk(SA2),pk(SA3)),after(Time&#xA0;3)))),and(thresh(2,pk(M1),pk(M2),pk(M3)),after(Time&#xA0;5)))</code></p>
<p>Compiled Output Descriptor:</p>
<p><code>&#xA0;&#xA0;&#xA0;wsh(or_i(and_v(v:thresh(2,pkh(M1),a:pkh(M2),a:pkh(M3)),after(Time&#xA0;5)),and_v(v:thresh(2,pk(A1),s:pk(A2),s:pk(A3),snl:after(Time&#xA0;4)),or_i(and_v(v:thresh(1,pkh(SA1),a:pkh(SA2),a:pkh(SA3)),after(Time&#xA0;3)),thresh(2,pk(P1),s:pk(P2),s:pk(P3),snl:after(Time&#xA0;2))))))</code></p>
<h1 id="reference_transactions">Reference Transactions</h1>
<p>Assumptions: Starting date of contract was January 1st, 2022 (1640995200). This means the timelock duration for each layer is as follows:</p>
<p>For example, if a contract started on January 1st 2022, the following epoch timestamp values would be used:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Calendar Date</th>
<th style="text-align: left;">Epoch Timestamp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Jan 1 2022</td>
<td style="text-align: left;">1640995200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jan 1 2023</td>
<td style="text-align: left;">1672531200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jan 31 2023</td>
<td style="text-align: left;">1675123200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Feb 15 2023</td>
<td style="text-align: left;">1676419200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">March 2 2023</td>
<td style="text-align: left;">1677715200</td>
</tr>
</tbody>
</table>
<ul>
<li>Layer 1 Transaction</li>
</ul>
<p>Signed By:</p>
<ul>
<li>Principle Keys 1 &amp; 2</li>
<li>Agent Keys 1 &amp; 2</li>
</ul>
<p><a href="https://mempool.space/testnet/tx/db089555614b8f677cb3e63c03dca45e3418d91b317117552513a7dafc9c0e9c">Reference TX</a></p>
<ul>
<li>Layer 2 Transaction</li>
</ul>
<p>Signed By:</p>
<ul>
<li>Principle Key 1</li>
<li>Agent Keys 1 &amp; 2</li>
</ul>
<p><a href="https://mempool.space/testnet/tx/ed3ec79fc26ca68f11043efee0d400fcac295b71e5173438c4fcc2280c6b30a2">Reference TX</a></p>
<ul>
<li>Layer 3 Transaction</li>
</ul>
<p>Signed by</p>
<ul>
<li>Agent keys 1 and 2</li>
<li>Sub agent key 1</li>
</ul>
<p><a href="https://mempool.space/testnet/tx/fac3dfef524edcfa4c0e38857456ca4b4a7c345f30a77b2bd0e736a1db19d08c">Reference TX</a></p>
<ul>
<li>Layer 4 Transaction</li>
</ul>
<p>Signed by:</p>
<ul>
<li>Agent key 1</li>
<li>Sub agent key 1</li>
</ul>
<p><a href="https://mempool.space/testnet/tx/978e158b46dd7d1dca86c20041b2706c058faac772a7ae2ccb786d7a249fa075">Reference TX</a></p>
<ul>
<li>Layer 5 Transaction</li>
<li>Signed by Recovery Key 1 and 2:</li>
</ul>
<p><a href="https://mempool.space/testnet/tx/7a3a78f097bac0a50fb4439d529d592f8687a2f52980db580888aaf9ae71259a">Reference TX</a></p>
</body>
</html>
